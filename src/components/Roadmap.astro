---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const roadmap = [
  {
    status: 'done',
    title: 'Phase 1: Foundations',
    items: [
      'Core Rule Engine (Rust)',
      'HTTP & gRPC API Server',
      'Visual Rule Editor (Vue 3)',
      'WASM Browser Execution',
      'Execution Tracing & Debugging',
      'Audit Logging'
    ]
  },
  {
    status: 'doing',
    title: 'Phase 2: Reliability',
    items: [
      'Local Persistence (SQLite)',
      'WAL (Write-Ahead Logging)',
      'Crash Recovery Mechanisms',
      'SDK Optimization'
    ]
  },
  {
    status: 'todo',
    title: 'Phase 3: Scale',
    items: [
      'Collaborative Editing',
      'Rule Marketplace',
      'Advanced Multi-tenancy',
      'Kubernetes Native Operator'
    ]
  }
];
---

<section id="roadmap" class="py-24 relative overflow-hidden reveal">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-20">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-4 font-mono">{t('roadmap.title')}</h2>
      <p class="text-slate-400 max-w-2xl mx-auto">
        {t('roadmap.desc')}
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      {roadmap.map(phase => (
        <div class="relative p-8 rounded-2xl bg-surface border border-white/5 flex flex-col">
          <div class="flex items-center gap-3 mb-6">
            <div class={`h-2.5 w-2.5 rounded-full ${phase.status === 'done' ? 'bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.5)]' : phase.status === 'doing' ? 'bg-brand animate-pulse shadow-[0_0_8px_rgba(249,115,22,0.5)]' : 'bg-slate-600'}`}></div>
            <span class={`text-[10px] font-bold uppercase tracking-widest font-mono ${phase.status === 'done' ? 'text-green-500' : phase.status === 'doing' ? 'text-brand' : 'text-slate-500'}`}>
              {phase.status === 'done' ? t('roadmap.status_done') : phase.status === 'doing' ? t('roadmap.status_doing') : t('roadmap.status_todo')}
            </span>
          </div>
          <h3 class="text-xl font-bold text-white mb-6 font-mono">{phase.title}</h3>
          <ul class="space-y-4 flex-grow">
            {phase.items.map(item => (
              <li class="flex items-start gap-3 text-sm text-slate-400">
                <svg xmlns="http://www.w3.org/2000/svg" class={`h-5 w-5 shrink-0 ${phase.status === 'done' ? 'text-green-500/50' : 'text-slate-700'}`} fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                {item}
              </li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  </div>
</section>
